#parse("pageheader.html")
#TreeFile()
<script src="/include/Hplus/js/fat_function.js" type="text/javascript"></script>
#if($config.Site_word) 
<script>
    $(function () {
        //拓词工具定时执行
        setInterval("getWord('title','content')", 5000);
    })
</script>
#end
<script>
    $(document).ready(function () {
        var tree = $("#tree").ligerTree({
            url: 'tree/treelist.aspx?act=downloadcatlisttree',
            parentIDFieldName: 'parent_id', idFieldName: 'cat_id', textFieldName: 'cat_name', childIcon: null, parentIcon: null, checkbox: false, topParentIDValue: '0',
            onClick: function (nodedata, target) { $(".fat_class").val(nodedata.data.cat_name); $(".cat_id").val(nodedata.data.cat_id); }
        }); //分类树
    });
</script>
 <div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
        <h2>
            #if($id == 0)添加#else修改#end下载</h2>
        <ol class="breadcrumb">
            <li><a href="main.aspx">主页</a> </li>
            <li><strong>下载</strong> </li>
        </ol>
    </div>
</div>


<div class="wrapper wrapper-content animated fadeInRight white-bg">
    <div class="row">
        <div class="col-lg-12">
            <a href="?act=list" class="btn btn-primary ">下载列表</a>
        </div>
    </div>
    <div class="row">
     <div class="col-lg-12">
            <div class="panel blank-panel">
            <div class="panel-heading">
                    <div class="panel-options">
                        <ul class="nav nav-tabs">
                            <li><a data-toggle="tab" href="#all-tab">基本信息</a></li>
                            <li><a data-toggle="tab" href="#detail-tab">介绍</a></li>
                            <li><a data-toggle="tab" href="#seo-tab">SEO</a></li>
                        </ul>
                    </div>
                </div>

                <!---->
                  <div class="panel-body">
                       <form method="post" class="form-horizontal" name="theForm" id="commentForm">
                        <div class="tab-content">
                        <div id="all-tab" class="tab-pane active">
                                 
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            下载标题：</label>
                                        <div class="col-sm-9">
                                                    <input id="title" name="title" maxlength="50" type="text" class="form-control" required="" aria-required="true" value="$!{entity.title}">
                                        </div>
                                    </div>
                                      <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            关键字：</label>
                                        <div class="col-sm-9">
                                        <input  name="keywords" maxlength="50" type="text" class="form-control" value="$!{entity.keywords}">
                                        </div>
                                    </div>
                                      <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            摘要：</label>
                                        <div class="col-sm-9">
                                       <textarea name="des" id="des" class="form-control" cols="50" rows="5" maxlength="300">$!{entity.des}</textarea>
                                        </div>
                                    </div>
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            上级分类：</label>
                                           <div class="col-sm-9 father_img">
                                <i class="fa fa-caret-down i_img"></i>
                                  <input   style="cursor:default; background-color:inherit; " type="text" readonly=readonly class="form-control fat_class" value="#if($!{entity.cat_id}>0)$!Caches.DownloadCategoryInfos($!{entity.cat_id}).cat_name #else 请选择分类... #end">
                                  <input class="cat_id" name="cat_id" type="hidden" value="$!{entity.cat_id}" />
                                    <div class="tree_class">
                                        <ul id="tree">
                                        </ul>
                                    </div>
                                </div>
                                    </div>
                                      <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            下载权限：</label>
                                        <div class="col-sm-9">
                                                <select name="user_rank"  class="form-control m-b" required="" aria-required="true">
                                                  #foreach($row in $User.GetUserGroupList())
                                                <option value="$!{row.rank_id}" #if($!{row.rank_id} == $!{entity.rank_id})selected="selected"#end>$!{row.rank_name}</option>
                                                #end
                                              </select>
                                        </div>
                                    </div>
                           
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            是否显示：</label>
                                        <div class="col-sm-9 radio i-checks">
                                                   <label>
                                    <input type="radio" #if($!{entity.is_enable})checked#end $SiteUtils.DefaultValue($!{entity.is_enable},"checked")  value="1" name="is_enable"> <i></i> 是</label>
                                    <label>
                                        <input type="radio"  #if($!{entity.is_enable} == false)checked#end  value="0" name="is_enable"> <i></i> 否</label>

                                        
                                        </div>
                                    </div>
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            是否推荐：</label>
                                        <div class="col-sm-9 radio i-checks">
                                                   <label>
                                    <input type="radio" #if($!{entity.is_top})checked#end $SiteUtils.DefaultValue($!{entity.is_top},"checked")  value="1" name="is_top"> <i></i> 是</label>
                                    <label>
                                        <input type="radio"  #if($!{entity.is_top} == false)checked#end  value="0" name="is_top"> <i></i> 否</label>

                                        
                                        </div>
                                    </div>
                                      <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            作者：</label>
                                        <div class="col-sm-9">
                                        <input  name="author" maxlength="50" type="text" class="form-control" value="$!{entity.author}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            来源：</label>
                                        <div class="col-sm-9">
                                        <input  name="source" maxlength="50" type="text" class="form-control" value="$!{entity.source}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            软件语言：</label>
                                        <div class="col-sm-9">
                                        <input  name="soft_lan" maxlength="50" type="text" class="form-control" value="$!{entity.soft_lan}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            软件大小：</label>
                                        <div class="col-sm-9">
                                        <input  name="filesize" maxlength="50" type="text" class="form-control" value="$!{entity.filesize}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            软件授权：</label>
                                        <div class="col-sm-9">
                                        <input  name="soft_authorize" maxlength="50" type="text" class="form-control" value="$!{entity.soft_authorize}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            应用平台：</label>
                                        <div class="col-sm-9">
                                        <input  name="platform" maxlength="50" type="text" class="form-control" value="$!{entity.platform}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            提 供 商：</label>
                                        <div class="col-sm-9">
                                        <input  name="provider" maxlength="50" type="text" class="form-control" value="$!{entity.provider}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            点击数：</label>
                                        <div class="col-sm-9">
                                        <input  name="click_count" maxlength="50" type="text" class="form-control number" value="$!{entity.click_count}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            下载数：</label>
                                        <div class="col-sm-9">
                                        <input  name="rank" maxlength="50" type="text" class="form-control number" value="$!{entity.rank}">
                                        </div>
                                    </div>
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            排序：</label>
                                        <div class="col-sm-9">
                                                   <input name="orderid" id="orderid" type="text" class="form-control number" required="" value="$SiteUtils.DefaultValue($!{entity.orderid},0)"/>
                                    </div>
                                    </div>
                                     <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            外部链接：</label>
                                        <div class="col-sm-9">
                                        <input  name="url" maxlength="50" type="text" class="form-control" value="$!{entity.url}" />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            上传图片：</label>
                                        <div class="col-sm-9">
                                                      <div class="upload_img">
                                        <img upload="image-single" class="img_show" onerror="javascript:this.src='images/slt.jpg' "
                                            src='$SiteUtils.DefaultValue($!{entity.photo},"images/slt.jpg")' />
                                        <input type="hidden" name="photo" id="photo" value="$!{entity.photo}" />
                                        <span class="help-inline">
                                            <button name="button" class="btn select_img btn-white btn-sm" type="button">
                                                点击上传</button></span>
                                    </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            上传文件：</label>
                                        <div class="col-sm-9">
                                                <div class="input-group m-b upload_file">
                                                <img upload="file-single" class="img_show" style="display:none" />
                                                <div class="input-group-btn">
                                                    <button name="button" class="btn select_file btn-white" type="button">点击上传</button>
                                                </div>
                                                <input name="filename" id="filename" type="text" value="$!{entity.filename}"  class="form-control" readonly />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            延时发布：</label>
                                        <div class="col-sm-9">
                                        <input  name="showtime" maxlength="50" type="text" class="laydate-icon form-control layer-date" onclick="laydate({istime: true, format: 'YYYY-MM-DD hh:mm:ss'})" value="$!{entity.showtime}">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            显示模板：</label>
                                        <div class="col-sm-9">
                                                    #if($entity.template_file.length>0)<button type="button" class="btn btn-w-m btn-white" onclick="javascript:updateTlp(this);">$!{entity.template_file}</button>#end
                                                    <select name="list_tlp" id="info_tlp" class="form-control m-b" #if($entity.template_file.length>0)style="display:none"#end>
                                                        <option value="">请选择...</option>
                                                        #foreach($row in $Caches.GetSiteTlp().Rows) #set($fname=$row.name.Substring(0,$row.name.LastIndexOf(".")))
                                                        <option value="$fname" #if($fname == $!entity.template_file)selected #end>$row.name#TlpSelect($fname) </option>
                                                        #end
                                                    </select>
                                        </div>
                                    </div>

                        </div>

                        <div id="detail-tab" class="tab-pane">
                             <div class="form-group">
                                        <textarea id="content" class="content" name="content" type="text/plain" style="width:100%;height:500px;">$!{entity.content}</textarea>                               
                            </div>
                        </div>
                           <div id="seo-tab" class="tab-pane">
                      
                             <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            页面标题：</label>
                                        <div class="col-sm-9">
                                                    <input name="pagetitle" maxlength="80" type="text" class="form-control" value="$!{entity.pagetitle}" placeholder="一般不超过80个字符">
                                        </div>
                             </div>
                             <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            页面关键词：</label>
                                        <div class="col-sm-9">
                                                    <textarea name="pagekeywords" class="form-control" rows="5" maxlength="100" placeholder="一般不超过100个字符">$!{entity.pagekeywords}</textarea>
                                        </div>
                                    </div>
                                <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            页面描述：</label>
                                        <div class="col-sm-9">
                                                    <textarea name="pagedesc" class="form-control" rows="5" maxlength="200" placeholder="一般不超过200个字符">$!{entity.pagedesc}</textarea>
                                        </div>
                                    </div>
                                 <div class="form-group">
                                        <label class="col-sm-1 control-label">
                                            自定义Url：</label>
                                        <div class="col-sm-9">
                                                    <input name="urlrewriter" type="text" class="form-control" value="$!{entity.urlrewriter}" placeholder="不填写则自动生成">
                                        </div>
                             </div>
                        </div>
                        <div class="row">
                            <div class="form-group">
                                        <div class="col-sm-2 col-sm-offset-2">
                                         <input type="hidden" name="cms_id" value="$!{entity.article_id}" />
                                            <button class="btn btn-primary" type="submit"><i class="fa fa-check"></i>提交</button>
                                            <button class="btn btn-white" type="reset">取消</button>

                                        </div>
                                    </div>
                        </div>
                         </div>
                    </form>
                </div>

             </div>
    </div>
    </div>
    </div>


<script type="text/javascript" src="js/tab.js"></script>
<script type="text/javascript"> 
var no_title = "没有下载标题";
var no_cat = "没有选择下载分类";
var not_allow_add = "不允许在一级分类添加下载";
function validate()
{
  var validator = new Validator('theForm');
  validator.required('title', no_title);
  validator.isNullOption('cat_id', no_cat);
  return validator.passed();
}

</script>
#parse("pagefooter.html")