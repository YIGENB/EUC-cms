<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="format-detection" content="telephone=no">


<title>幸运大转盘抽奖</title>
<link href="/include/activities/css/dzp-style.css" rel="stylesheet" type="text/css">
</head>

<body class="activity-lottery-winning">
<div class="main">

 <div id="outercont">
<div id="outer-cont">
<div id="outer"><img src="/include/activities/images/activity-lottery-5.png"></div>
</div>
<div id="inner-cont">
<div id="inner"><img src="/include/activities/images/activity-lottery-2.png"></div>
</div>
</div>
<div class="content">
<div class="boxcontent boxyellow" id="result" style="display:none">
<div class="box">
<div class="title-orange"><span>恭喜你中奖了</span></div>
<div class="Detail">
	<p>你中了：<span class="red" id="prizetype">   </span></p>
	<p>兑奖SN码：<span class="red" id="sncode"></span></p>
<!--	<p class="red" id="red">本次兑奖码已经关联你的微信号，你可向公众号发送【大转盘】进行查询!  </p>-->
<p>
	<input name="" class="px" id="username" placeholder="请输入您的姓名" type="text">
</p>    
	<p>
	<input name="" class="px" id="tel" placeholder="用户请输入您的手机号" type="text">
	</p>
	<p>
	<input class="pxbtn" name="提 交" id="save-btn" value="用户提交" type="button">
	</p>
<!--	<p>
	<input name="" class="px" id="parssword" value="" placeholder="商家输入兑奖密码" type="password">
	</p>-->
<!--	<p>
	<input class="pxbtn" name="提 交" id="save-btnn" value="商家提交" type="button">
	</p>-->
</div>
</div>
</div>
    <div class="boxcontent boxyellow">
        <div class="box">
            <div class="title-green"><span>奖项设置：</span></div>
            <div class="Detail">
                #foreach($row in $award)
                <p>$row.type：$row.name。数量：$row.count </p>  
                #end
            </div>
        </div>
    </div>
<div class="boxcontent boxyellow">
<div class="box">
<div class="title-green">使用说明：</div>
<div class="Detail">

                <p> <span><span>$entity.des</span></span></p>
</div>
</div>
</div>
<div class="boxcontent boxyellow">
<div class="box">
<div class="title-green">活动说明：</div>
<div class="Detail">
<p> <span><span>$entity.des</span></span></p>
</div>
</div>
</div>
</div>

</div>

<script src="/include/activities/js/jquery.js" type="text/javascript"></script> 
<script src="/include/activities/js/alert.js" type="text/javascript"></script>
<style type="text/css">

.window {
	width:290px;
	position:absolute;
	display:none;
	bottom:30px;
	left:50%;
	 z-index:9999;
	margin:-50px auto 0 -145px;
	padding:2px;
	border-radius:0.6em;
	-webkit-border-radius:0.6em;
	-moz-border-radius:0.6em;
	background-color: #ffffff;
	-webkit-box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
	-moz-box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
	-o-box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
	font:14px/1.5 Microsoft YaHei,Helvitica,Verdana,Arial,san-serif;
}
.window .title {
	
	background-color: #A3A2A1;
	line-height: 26px;
    padding: 5px 5px 5px 10px;
	color:#ffffff;
	font-size:16px;
	border-radius:0.5em 0.5em 0 0;
	-webkit-border-radius:0.5em 0.5em 0 0;
	-moz-border-radius:0.5em 0.5em 0 0;
	background-image: -webkit-gradient(linear, left top, left bottom, from( #585858 ), to( #565656 )); /* Saf4+, Chrome */
	background-image: -webkit-linear-gradient(#585858, #565656); /* Chrome 10+, Saf5.1+ */
	background-image:    -moz-linear-gradient(#585858, #565656); /* FF3.6 */
	background-image:     -ms-linear-gradient(#585858, #565656); /* IE10 */
	background-image:      -o-linear-gradient(#585858, #565656); /* Opera 11.10+ */
	background-image:         linear-gradient(#585858, #565656);
	
}
.window .content {
	/*min-height:100px;*/
	overflow:auto;
	padding:10px;
	background: linear-gradient(#FBFBFB, #EEEEEE) repeat scroll 0 0 #FFF9DF;
    color: #222222;
    text-shadow: 0 1px 0 #FFFFFF;
	border-radius: 0 0 0.6em 0.6em;
	-webkit-border-radius: 0 0 0.6em 0.6em;
	-moz-border-radius: 0 0 0.6em 0.6em;
}
.window #txt {
	min-height:30px;font-size:16px; line-height:22px;
}
.window .txtbtn {
	
	background: #f1f1f1;
	background-image: -webkit-gradient(linear, left top, left bottom, from( #DCDCDC ), to( #f1f1f1 )); /* Saf4+, Chrome */
	background-image: -webkit-linear-gradient( #ffffff , #DCDCDC ); /* Chrome 10+, Saf5.1+ */
	background-image:    -moz-linear-gradient( #ffffff , #DCDCDC ); /* FF3.6 */
	background-image:     -ms-linear-gradient( #ffffff , #DCDCDC ); /* IE10 */
	background-image:      -o-linear-gradient( #ffffff , #DCDCDC ); /* Opera 11.10+ */
	background-image:         linear-gradient( #ffffff , #DCDCDC );
	border: 1px solid #CCCCCC;
	border-bottom: 1px solid #B4B4B4;
	color: #555555;
	font-weight: bold;
	text-shadow: 0 1px 0 #FFFFFF;
	border-radius: 0.6em 0.6em 0.6em 0.6em;
	display: block;
	width: 100%;
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
	text-overflow: ellipsis;
	white-space: nowrap;
	cursor: pointer;
	text-align: windowcenter;
	font-weight: bold;
	font-size: 18px;
	padding:6px;
	margin:10px 0 0 0;
}
.window .txtbtn:visited {
	background-image: -webkit-gradient(linear, left top, left bottom, from( #ffffff ), to( #cccccc )); /* Saf4+, Chrome */
	background-image: -webkit-linear-gradient( #ffffff , #cccccc ); /* Chrome 10+, Saf5.1+ */
	background-image:    -moz-linear-gradient( #ffffff , #cccccc ); /* FF3.6 */
	background-image:     -ms-linear-gradient( #ffffff , #cccccc ); /* IE10 */
	background-image:      -o-linear-gradient( #ffffff , #cccccc ); /* Opera 11.10+ */
	background-image:         linear-gradient( #ffffff , #cccccc );
}
.window .txtbtn:hover {
	background-image: -webkit-gradient(linear, left top, left bottom, from( #ffffff ), to( #cccccc )); /* Saf4+, Chrome */
	background-image: -webkit-linear-gradient( #ffffff , #cccccc ); /* Chrome 10+, Saf5.1+ */
	background-image:    -moz-linear-gradient( #ffffff , #cccccc ); /* FF3.6 */
	background-image:     -ms-linear-gradient( #ffffff , #cccccc ); /* IE10 */
	background-image:      -o-linear-gradient( #ffffff , #cccccc ); /* Opera 11.10+ */
	background-image:         linear-gradient( #ffffff , #cccccc );
}
.window .txtbtn:active {
	background-image: -webkit-gradient(linear, left top, left bottom, from( #cccccc ), to( #ffffff )); /* Saf4+, Chrome */
	background-image: -webkit-linear-gradient( #cccccc , #ffffff ); /* Chrome 10+, Saf5.1+ */
	background-image:    -moz-linear-gradient( #cccccc , #ffffff ); /* FF3.6 */
	background-image:     -ms-linear-gradient( #cccccc , #ffffff ); /* IE10 */
	background-image:      -o-linear-gradient( #cccccc , #ffffff ); /* Opera 11.10+ */
	background-image:         linear-gradient( #cccccc , #ffffff );
	border: 1px solid #C9C9C9;
	border-top: 1px solid #B4B4B4;
	box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3) inset;
}

.window .title .close {
	float:right;
	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACTSURBVEhL7dNtCoAgDAZgb60nsGN1tPLVCVNHmg76kQ8E1mwv+GG27cestQ4PvTZ69SFocBGpWa8+zHt/Up+IN+MhgLlUmnIE1CpBQB2COZibfpnXhHFaIZkYph0SOeeK/QJ8o7KOek84fkCWSBtfL+Ny2MPpCkPFMH6PWEhWhKncIyEk69VfiUuVhqJefds+YcwNbEwxGqGIFWYAAAAASUVORK5CYII=");
	width:26px;
	height:26px;
	display:block;	
}
</style>
<div class="window" id="windowcenter">
	<div id="title" class="title">消息提醒<span class="close" id="alertclose"></span></div>
	<div class="content">
	 <div id="txt"></div>
	 <input value="确定" id="windowclosebutton" name="确定" class="txtbtn" type="button">	
	</div>
</div>
 
<script type="text/javascript">
    $(document).ready(function () {
        window.requestAnimFrame = (function () {
            return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {
                window.setTimeout(callback, 1000 / 60)
            }
        })();
        var totalDeg = 360 * 3 + 0;
        var steps = [];
        var lostDeg = [30, 90, 150, 210, 270, 330];
        var prizeDeg = [0, 60, 120, 180, 240, 300];
        var prize, sncode;
        var count = 0;
        var now = 0;
        var a = 0.01;
        var outter, inner, timer, running = false;
        function countSteps() {
            var t = Math.sqrt(2 * totalDeg / a);
            var v = a * t;
            for (var i = 0; i < t; i++) {
                steps.push((2 * v * i - a * i * i) / 2)
            }
            steps.push(totalDeg)
        }
        function step() {
            outter.style.webkitTransform = 'rotate(' + steps[now++] + 'deg)';
            outter.style.MozTransform = 'rotate(' + steps[now++] + 'deg)';
            if (now < steps.length) {
                running = true;
                requestAnimFrame(step)
            } else {
                running = false;
                setTimeout(function () {
                    if (prize != null) {
                        $("#sncode").text('$sncode');
                        var type = "";
                        if (prize == 1) {
                            type = "一等奖"
                        } else if (prize == 2) {
                            type = "二等奖"
                        } else if (prize == 3) {
                            type = "三等奖"
                        }
                        else if (prize == 4) {
                            type = "四等奖"
                        }
                        else if (prize == 5) {
                            type = "五等奖"
                        }
                        $("#prizetype").text(type);
                        $("#result").slideToggle(500);
                        $("#outercont").slideUp(500)
                    } else {
                        alert("亲，继续努力哦！")
                    }
                }, 200)
            }
        }
        function start(deg) {
            var n = parseInt(lostDeg.length * Math.random())
            //alert(n)
            deg = deg || lostDeg[parseInt(n)];
            running = true;
            clearInterval(timer);
            totalDeg = 360 * 5 + deg;
            steps = [];
            now = 0;
            countSteps();
            requestAnimFrame(step)
        }
        window.start = start;
        outter = document.getElementById('outer');
        inner = document.getElementById('inner');
        i = 10;
        $("#inner").click(function () {
            if (running) return;
            if ($countlog > $day_users) {
                alert("今天的次数已达最大,不能再抽了,明天再来吧!");
                return
            }
            if ($count_user_log >= $user_day_count) {
                alert("您已经抽了  $user_day_count 次奖,不能再抽了,明天再来吧!");
                return
            }
            if (prize != null) {
                alert("亲，你不能再参加本次活动了喔！明天再来吧~");
                return
            }
            if ($exchangeid > 0) {
                prize = $awardtype;
                sncode = "$sncode";
                start(prizeDeg[prize - 1]);
            } else {
                prize = null;
                start()
            }
            running = false;
            count++;
        })
    });
    var username = jQuery("#username").val();
    var exchangeid = '$exchangeid';
    var tel = jQuery("#tel").val();
    jQuery("#save-btn").click(function () {
        jQuery.post("/tools/ajax.aspx",
    {
        act: "exchange",
        phone: $("#tel").val(),
        name: $("#username").val(),
        exchangeid: '$exchangeid'
    },
    function (data, status) {
        $("#windowcenter").show();
        $("#zjl").hide();
        $("#txt").html("您的sncode为：\n $sncode \n工作人员会尽快联系您确定信息"); //您的sncode为：\n"+sncode+"<br/>工作人员会尽快联系您确定信息
    });

        jQuery("#windowclosebutton").click(function () {
            $("#result").hide();
            $("#outercont").show();
        })

    });
</script>
</body>
</html>